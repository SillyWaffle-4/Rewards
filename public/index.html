<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Awards Dashboard</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; margin: 20px; background: #f4f4f9; color: #333; }
        .header { text-align: center; margin-bottom: 30px; }
        
        /* THE FIX: Side-by-side columns */
        .columns-container { display: flex; justify-content: center; gap: 20px; flex-wrap: wrap; }
        
        .column { background: white; padding: 25px; border-radius: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); flex: 1; min-width: 320px; max-width: 450px; }
        .score-display { font-size: 2em; color: #26c84c; font-weight: bold; margin: 10px 0; }
        
        h2 { border-bottom: 3px solid #26c84c; padding-bottom: 10px; }
        label { display: block; padding: 10px; border-radius: 5px; cursor: pointer; transition: 0.2s; }
        label:hover { background: #e8f5e9; }
        
        input[type="checkbox"] { transform: scale(1.3); margin-right: 15px; }
        input[type="password"], input[type="number"] { padding: 10px; border: 1px solid #ccc; border-radius: 5px; margin: 5px 0; width: 100%; box-sizing: border-box; }
        
        button { padding: 12px; background: #26c84c; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; width: 100%; margin-top: 10px; }
        button:hover { background: #1b8a35; }
        .reset-btn { background: #ff4d4d; margin-top: 40px; }
    </style>
</head>
<body>

    <div class="header">
        <h1>üèÜ Family Awards Page</h1>
        <input type="password" id="password" placeholder="Admin Password" style="width: 250px;">
        <button onclick="checkAdmin()" style="width: 150px;">Unlock</button>
    </div>

    <div class="columns-container">
        <div class="column">
            <h2>üë¶ Aiden</h2>
            <div class="score-display">Pts: <span id="points-aiden">0</span></div>
            <label><input type="checkbox" id="Flute" disabled onclick="handleToggle(this, 10, 'aiden')">Flute (10)</label>
            <label><input type="checkbox" id="Aplus" disabled onclick="handleToggle(this, 15, 'aiden')">A+ (15)</label>
            <label><input type="checkbox" id="BYSO" disabled onclick="handleToggle(this, 13, 'aiden')">BYSO (13)</label>
            <label><input type="checkbox" id="Chinese" disabled onclick="handleToggle(this, 5, 'aiden')">Chinese (5)</label>
            <label><input type="checkbox" id="Boba" disabled onclick="handleToggle(this, -6, 'aiden')">Boba Day (-6)</label>
            <label><input type="checkbox" id="Movie" disabled onclick="handleToggle(this, -180, 'aiden')">Movie Day (-180)</label>
            <hr>
            <input type="number" id="custom-aiden" placeholder="Custom Points">
            <button onclick="manualAdd('custom-aiden', 'aiden')">Update Aiden</button>
        </div>

        <div class="column">
            <h2>üë¶ Ethan</h2>
            <div class="score-display">Pts: <span id="points-ethan">0</span></div>
            <label><input type="checkbox" id="Piano" disabled onclick="handleToggle(this, 10, 'ethan')">Piano (10)</label>
            <label><input type="checkbox" id="AplusE" disabled onclick="handleToggle(this, 15, 'ethan')">A+ (15)</label>
            <label><input type="checkbox" id="Spanish" disabled onclick="handleToggle(this, 5, 'ethan')">Spanish (5)</label>
            <label><input type="checkbox" id="IceCream" disabled onclick="handleToggle(this, -20, 'ethan')">Boba (-20)</label>
            <label><input type="checkbox" id="Swimming" disabled onclick="handleToggle(this, 10, 'ethan')">Swimming (10)</label>
            <label><input type="checkbox" id="GameDay" disabled onclick="handleToggle(this, -180, 'ethan')">Movie Day (-180)</label>
            <hr>
            <input type="number" id="custom-ethan" placeholder="Custom Points">
            <button onclick="manualAdd('custom-ethan', 'ethan')">Update Ethan</button>
        </div>
    </div>

    <div style="max-width: 400px; margin: 0 auto;">
        <button class="reset-btn" onclick="resetPoints()">Manual Monday Reset</button>
    </div>

    <script>
        let admin = false;

        async function updateUI(data) {
            document.getElementById('points-aiden').innerText = data.aidenPoints || 0;
            document.getElementById('points-ethan').innerText = data.ethanPoints || 0;
            if (data.completedTasks) {
                data.completedTasks.forEach(id => {
                    const el = document.getElementById(id);
                    if (el) el.checked = true;
                });
            }
        }

        window.onload = async () => {
            const res = await fetch('/get-points');
            const data = await res.json();
            updateUI(data);
        };

        async function checkAdmin() {
            const res = await fetch('/check-admin', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ password: document.getElementById('password').value })
            });
            const result = await res.json();
            if (result.success) {
                admin = true;
                document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.disabled = false);
                alert('Admin Access Granted!');
            } else { alert('Incorrect password!'); }
        }

        async function handleToggle(checkbox, points, userType) {
            const route = checkbox.checked ? '/give-points' : '/remove-points';
            const res = await fetch(route, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ points: Math.abs(points), taskId: checkbox.id, userType })
            });
            updateUI(await res.json());
        }

        async function manualAdd(inputId, userType) {
            const val = document.getElementById(inputId).value;
            const res = await fetch('/give-points', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ points: val, taskId: 'manual-' + Date.now(), userType })
            });
            updateUI(await res.json());
        }

        async function resetPoints() {
            if (!admin) return alert('Admin only!');
            const res = await fetch('/reset-points', { method: 'POST' });
            document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
            updateUI(await res.json());
            alert('Reset complete!');
        }
    </script>
</body>
</html>